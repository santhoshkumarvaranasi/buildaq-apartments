import{a as l,b as g,c}from"./chunk-2VMXMS7J.js";var v={singleton:!1,requiredVersionPrefix:""};function te(e=v){let o=window.__NATIVE_FEDERATION__.externals,n={},a=[...o.keys()].filter(s=>!s.startsWith("/@id/")&&!s.startsWith("@angular-architects/module-federation")&&!s.endsWith("@")).sort();for(let s of a){let i=s.lastIndexOf("@"),f=s.substring(0,i),u=s.substring(i+1),m=o.get(s)??"",O={version:u,get:()=>c(null,null,function*(){let P=yield window.importShim(m);return()=>P}),shareConfig:{singleton:e.singleton,requiredVersion:e.requiredVersionPrefix+u}};n[f]||(n[f]=[]),n[f].push(O)}return n}var b="__NATIVE_FEDERATION__",I=globalThis;I[b]??={externals:new Map,remoteNamesToRemote:new Map,baseUrlToRemoteNames:new Map};var h=I[b],x=h.externals;function T(e){return`${e.packageName}@${e.version}`}function j(e){let t=T(e);return x.get(t)}function M(e,t){let o=T(e);x.set(o,t)}function F(e,t){return{imports:l(l({},e.imports),t.imports),scopes:l(l({},e.scopes),t.scopes)}}var S=h.remoteNamesToRemote,y=h.baseUrlToRemoteNames;function A(e,t){S.set(e,t),y.set(t.baseUrl,e)}function D(e){return y.get(e)}function L(e){return y.has(e)}function U(e){return S.get(e)}var E=globalThis,d;function W(){if(d===void 0&&(d=null,E.trustedTypes))try{d=E.trustedTypes.createPolicy("native-federation",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return d}function N(e){return W()?.createScript(e)??e}function k(e){document.head.appendChild(Object.assign(document.createElement("script"),{type:N("importmap-shim"),textContent:N(JSON.stringify(e))}))}function w(e){let t=e.split("/");return t.pop(),t.join("/")}function p(e,t){for(;e.endsWith("/");)e=e.substring(0,e.length-1);return t.startsWith("./")&&(t=t.substring(2,t.length)),`${e}/${t}`}var oe="/@angular-architects/native-federation:build-notifications",C=(function(e){return e.COMPLETED="federation-rebuild-complete",e.ERROR="federation-rebuild-error",e.CANCELLED="federation-rebuild-cancelled",e})(C||{});function K(e){let t=new EventSource(e);t.onmessage=function(o){JSON.parse(o.data).type===C.COMPLETED&&(console.log("[Federation] Rebuild completed, reloading..."),window.location.reload())},t.onerror=function(o){console.warn("[Federation] SSE connection error:",o)}}function ne(){return c(this,arguments,function*(e={},t){let o=t?.cacheTag?`?t=${t.cacheTag}`:"",n=typeof e=="string"?yield V(e+o):e,r=yield _(`./remoteEntry.json${o}`),a=yield Q(r),s=yield B(n,l({throwIfRemoteNotFound:!1},t)),i=F(a,s);return k(i),i})}function V(e){return c(this,null,function*(){return yield fetch(e).then(o=>o.json())})}function z(e,t){if(!t)return e;let o=e.includes("?")?"&":"?";return`${e}${o}t=${t}`}function q(e,t,o,n){let r=`Error loading remote entry for ${e} from file ${t}`;if(o.throwIfRemoteNotFound)throw new Error(r);return console.error(r),console.error(n),null}function B(o){return c(this,arguments,function*(e,t={throwIfRemoteNotFound:!1}){let n=Object.entries(e).map(f=>c(null,[f],function*([s,i]){try{let u=z(i,t.cacheTag);return yield $(u,s)}catch(u){return q(s,i,t,u)}}));return(yield Promise.all(n)).reduce((s,i)=>i?F(s,i):s,{imports:{},scopes:{}})})}function $(e,t){return c(this,null,function*(){let o=w(e),n=yield _(e);t||(t=n.name),n.buildNotificationsEndpoint&&K(o+n.buildNotificationsEndpoint);let r=H(n,t,o);return A(t,g(l({},n),{baseUrl:o})),r})}function H(e,t,o){let n=G(e,t,o),r=J(e,o);return{imports:n,scopes:r}}function _(e){return c(this,null,function*(){return yield fetch(e).then(o=>o.json())})}function J(e,t){let o={},n={};for(let r of e.shared){let a=j(r)??p(t,r.outFileName);M(r,a),n[r.packageName]=a}return o[t+"/"]=n,o}function G(e,t,o){let n={};for(let r of e.exposes){let a=p(t,r.key),s=p(o,r.outFileName);n[a]=s}return n}function Q(e,t="./"){return c(this,null,function*(){let o=e.shared.reduce((n,r)=>g(l({},n),{[r.packageName]:t+r.outFileName}),{});for(let n of e.shared)M(n,t+n.outFileName);return{imports:o,scopes:{}}})}function re(e,t){return c(this,null,function*(){let o=ee(e,t);yield Z(o);let n=Y(o),r=U(n),a=o.fallback,s=r?"":"unknown remote "+n;if(!r&&!a)throw new Error(s);if(!r)return R(s),Promise.resolve(a);let i=r.exposes.find(m=>m.key===o.exposedModule),f=i?"":`Unknown exposed module ${o.exposedModule} in remote ${n}`;if(!i&&!a)throw new Error(f);if(!i)return R(f),Promise.resolve(a);let u=p(r.baseUrl,i.outFileName);try{return X(u)}catch(m){if(a)return console.error("error loading remote module",m),a;throw m}})}function X(e){return typeof importShim<"u"?importShim(e):import(e)}function Y(e){let t;if(e.remoteName)t=e.remoteName;else if(e.remoteEntry){let o=w(e.remoteEntry);t=D(o)}else throw new Error("unexpected arguments: Please pass remoteName or remoteEntry");if(!t)throw new Error("unknown remoteName "+t);return t}function Z(e){return c(this,null,function*(){if(e.remoteEntry&&!L(w(e.remoteEntry))){let t=yield $(e.remoteEntry);k(t)}})}function ee(e,t){let o;if(typeof e=="string"&&t)o={remoteName:e,exposedModule:t};else if(typeof e=="object"&&!t)o=e;else throw new Error("unexpected arguments: please pass options or a remoteName/exposedModule-pair");return o}function R(e){typeof window<"u"&&console.error(e)}export{oe as BUILD_NOTIFICATIONS_ENDPOINT,C as BuildNotificationType,$ as fetchAndRegisterRemote,te as getShared,ne as initFederation,re as loadRemoteModule,F as mergeImportMaps,Q as processHostInfo,B as processRemoteInfos};
